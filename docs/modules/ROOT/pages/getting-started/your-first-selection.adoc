= Your First Selection
:description: Create your first PSD3 visualization in 10 minutes
:keywords: tutorial, getting started, PureScript, D3, visualization

In this tutorial, you'll create a simple visualization using PSD3. By the end, you'll understand the core pattern: build a *tree AST* that describes your visualization, then interpret it to render.

== Prerequisites

- PureScript and Spago installed
- Basic familiarity with PureScript syntax
- A project with `psd3-selection` installed:

[source,bash]
----
spago install psd3-selection
----

== The Core Pattern

PSD3 is different from D3.js. Instead of imperative method chaining:

[source,javascript]
----
// D3.js (imperative)
d3.select("body")
  .append("svg")
  .attr("width", 400)
  .attr("height", 300)
  .append("circle")
  .attr("cx", 200)
  .attr("cy", 150)
  .attr("r", 50)
  .attr("fill", "steelblue");
----

You build a *tree* that describes what you want:

[source,purescript]
----
-- PSD3 (declarative)
myViz :: A.AST Unit
myViz =
  A.elem SVG
    [ width (num 400.0)
    , height (num 300.0)
    ]
    `A.withChild`
      A.elem Circle
        [ cx (num 200.0)
        , cy (num 150.0)
        , r (num 50.0)
        , fill (text "steelblue")
        ]
----

Then you render that tree to the DOM. The tree is *data* - you can inspect it, transform it, test it.

== Step 1: Imports

Create a file `src/Main.purs`:

[source,purescript]
----
module Main where

import Prelude

import Effect (Effect)
import Effect.Console (log)

import PSD3.AST as A
import PSD3.AST (ElementType(..))
import PSD3.Expr.Friendly (num, text, width, height, cx, cy, r, fill)
import PSD3.Render (runD3, select, renderTree)
----

The key imports are:

- `PSD3.AST` - Tree building functions (`elem`, `withChild`, etc.)
- `PSD3.AST (ElementType(..))` - Element types (`SVG`, `Circle`, `Rect`, etc.)
- `PSD3.Expr.Friendly` - Attribute helpers (`num`, `text`, `width`, `cx`, etc.)
- `PSD3.Render` - Rendering functions (`runD3`, `select`, `renderTree`)

== Step 2: Build the Tree

[source,purescript]
----
myViz :: A.AST Unit
myViz =
  A.elem SVG
    [ width (num 400.0)
    , height (num 300.0)
    ]
    `A.withChild`
      A.elem Circle
        [ cx (num 200.0)
        , cy (num 150.0)
        , r (num 50.0)
        , fill (text "steelblue")
        ]
----

Let's break this down:

`A.AST Unit`:: The tree type. `Unit` means we're not binding any data yet.

`A.elem SVG [...]`:: Create an SVG element with attributes.

`width (num 400.0)`:: Set width to 400. `num` wraps a number in the expression system.

`\`A.withChild\``:: Add a child element. The backticks make it infix.

`fill (text "steelblue")`:: String attributes use `text` instead of `num`.

== Step 3: Render to the DOM

[source,purescript]
----
main :: Effect Unit
main = void $ runD3 do
  container <- select "body"
  renderTree container myViz
  pure unit
----

`runD3`:: Runs a D3 computation in the Effect monad.

`select "body"`:: Select the body element as our container.

`renderTree container myViz`:: Render the AST into the container.

== Complete Example

[source,purescript]
----
module Main where

import Prelude

import Effect (Effect)

import PSD3.AST as A
import PSD3.AST (ElementType(..))
import PSD3.Expr.Friendly (num, text, width, height, cx, cy, r, fill)
import PSD3.Render (runD3, select, renderTree)

myViz :: A.AST Unit
myViz =
  A.elem SVG
    [ width (num 400.0)
    , height (num 300.0)
    ]
    `A.withChild`
      A.elem Circle
        [ cx (num 200.0)
        , cy (num 150.0)
        , r (num 50.0)
        , fill (text "steelblue")
        ]

main :: Effect Unit
main = void $ runD3 do
  container <- select "body"
  renderTree container myViz
  pure unit
----

== Adding More Elements

Use `withChildren` to add multiple children:

[source,purescript]
----
myViz :: A.AST Unit
myViz =
  A.elem SVG
    [ width (num 400.0)
    , height (num 300.0)
    ]
    `A.withChildren`
      [ A.elem Circle
          [ cx (num 100.0), cy (num 150.0), r (num 40.0)
          , fill (text "steelblue")
          ]
      , A.elem Circle
          [ cx (num 200.0), cy (num 150.0), r (num 40.0)
          , fill (text "coral")
          ]
      , A.elem Circle
          [ cx (num 300.0), cy (num 150.0), r (num 40.0)
          , fill (text "seagreen")
          ]
      ]
----

== Nesting Elements

Trees can be nested arbitrarily deep:

[source,purescript]
----
import PSD3.AST (ElementType(..))  -- includes Group
import PSD3.Expr.Friendly (transform)

myViz :: A.AST Unit
myViz =
  A.elem SVG
    [ width (num 400.0), height (num 300.0) ]
    `A.withChild`
      A.elem Group
        [ transform (text "translate(200, 150)") ]
        `A.withChildren`
          [ A.elem Circle [ r (num 50.0), fill (text "steelblue") ]
          , A.elem Circle [ r (num 30.0), fill (text "white") ]
          ]
----

== Named Elements

Use `A.named` instead of `A.elem` when you need to reference an element later:

[source,purescript]
----
myViz :: A.AST Unit
myViz =
  A.named SVG "chart"
    [ width (num 400.0), height (num 300.0) ]
    `A.withChild`
      A.named Circle "mainCircle"
        [ cx (num 200.0), cy (num 150.0), r (num 50.0)
        , fill (text "steelblue")
        ]
----

Named selections can be retrieved after rendering for updates or attaching behaviors.

== What You've Learned

1. **Build trees, not commands** - PSD3 visualizations are data structures
2. **`A.elem`** creates anonymous elements, **`A.named`** creates retrievable ones
3. **`withChild`** and **`withChildren`** nest elements
4. **`num`** and **`text`** wrap values for the attribute system
5. **`runD3`** executes the rendering

== Next Steps

- xref:getting-started/bar-chart.adoc[Building a Bar Chart] - Data binding with `joinData`
- xref:how-to/coordinated-highlighting.adoc[Coordinated Highlighting] - Interactive behaviors
- xref:understanding/the-ast.adoc[The Selection AST] - Deep dive into the tree structure
